### 05. 서비스 환경에 클러스터 구성

#### 5.1 운영 환경을 위한 설정과 클러스터 구성
###### 5.1.1 노드 설정과 노드 역할 
- 클러스터 구성을 위해서는 반드시 노드에 역할을 지정
  - 마스터 노드: 클러스터 관리
  - 데이터 노드: 실제 데이터를 들고 있는 노드
  - 인제스트 노드: 인제스트 파이프라인 수행 노드
  - 조정 노드: 클라이언트의 요청을 받아서 다른 노드에 요청을 분배하고 응답을 돌려주는 노드, 기본적으로 모든 노드가 이 역할 수행
  - 원격 클러스터 클라이언트 노드: 엘라스틱서치 클러스터에 클라이언트로 붙는 노드 
  - 데이터 티어 노드
###### 5.1.2 그 외 필요한 주요 설정
- 적절한 힙 크기 지정 
  - 최소한 시스템 메모리의 절반 이하
  - 힙 크기를 32GB 이상 지정하지 않아야 함 
- 스와핑을 사용하지 않도록 권고함 
- 파일 기술자를 최소 65535 이상으로 설정하도록 권고
- 특별한 사유가 없다면 내장 JDK 사용 

#### 5.2 클러스터 구성 전략
###### 5.2.1 마스터 후보 노드와 데이터 노드 분리 
- 마스터 후보 노드는 데이터 노드보다 상대적으로 성능이 낮은 서버 이용 
###### 5.2.2 마스터 후보 노드와 투표 구성원 
- 마스터 노드는 클러스터 관리하는 중요한 역할 수행
- 마스터 후보 노드는 홀수대 준비 
###### 5.2.3 서버 자원이 많지 않은 경우 
- 노드 3대가 확보돼야 클러스터를 구성하는 의미가 있음 
###### 5.2.4 서버 자원이 굉장히 많이 필요한 경우
###### 5.2.5 사양이 크게 차이나는 서버 자원을 활용해야 하는 경우 
- 데이터 티어 구조 도입 고려
###### 5.2.6 조정 전용 노드
- 조정 전용 노드를 두는 것이 좋음 
- 키바나가 조정 전용 노드만을 바라보게 설정
###### 5.2.7 한 서버에 여러 프로세스 띄우기
- 마스터 후보 역할을 하는 프로세스는 다중 프로세스 대상으로 고려하지 말기

#### 5.3 보안 기능 적용
###### 5.3.1 모든 보안 기능을 적용하지 않은 상태 
###### 5.3.2 TLS 부트스트랩 체크
###### 5.3.3 클러스터 최초 기동 시 자동 보안 설정 이용
###### 5.3.4 키바나와 브라우저 사이에 TLS 적용
###### 5.3.5 수동으로 엘라스틱서치 노드 간의 통신에 TLS 적용
###### 5.3.6 수동으로 기본 인증 설정 